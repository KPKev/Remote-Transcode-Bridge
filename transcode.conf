# =============================================================
# Transcode Script Configuration (transcode.conf)
# =============================================================
# Copy or edit this file to change behaviour without touching
# the main transcode-to-mp4-with-gpu.sh script. Any variable
# defined here overrides the script's internal default.
# =============================================================

# ----------------- SSH / Remote GPU -----------------
SSH_HOST="192.168.7.16"    # IP or hostname of Windows box running NVENC
SSH_PORT="22"              # SSH port (22 by default)
SSH_USER="12227"           # SSH login user
SSH_KEY="/config/.ssh/id_rsa"  # Private key path inside container

# ----------------- Encoding Targets -----------------
# Video quality caps for Plex Direct-Play
BITRATE_TARGET="6M"        # Average bitrate target (VBR-HQ)
BITRATE_MAX="8M"           # Peak maxrate (≤ 8 Mbit/s)
BITRATE_BUFSIZE="16M"      # Rate-control buffer
RESOLUTION_MAX="1920x1080" # Max output resolution (widthxheight)

# ----------------- Transcoder Priority & Control -----------------
# Define the order of transcoders to try. The script will attempt them
# in this sequence. If one fails or is disabled, it moves to the next.
# Available options: "remote_igpu", "remote_dgpu", "local_cpu"
# Default is "remote_igpu remote_dgpu local_cpu"
TRANSCODE_PRIORITY="remote_igpu remote_dgpu local_cpu"

# --- Individual Transcoder Settings ---
# Enable or disable each specific transcoder. Set to "true" or "false".
ENABLE_REMOTE_IGPU="true"
ENABLE_REMOTE_DGPU="false"
ENABLE_LOCAL_CPU="true"

# --- iGPU (Intel QSV) Settings ---
# Preset for QSV encoder (e.g., veryfast, faster, fast, medium, slow, slower, veryslow)
# A slower preset means better quality for the same bitrate.
QSV_PRESET="slow"

# --- dGPU (Nvidia NVENC) Settings ---
# Preset for NVENC encoder (e.g., p1-p7, with p4=slow, p5=medium, p6=fast)
# A lower number preset (p1-p4) means better quality.
NVENC_PRESET="p4"          # Quality preset for h264_nvenc (p4 ≈ slow)

# ----------------- Logging -----------------
LOG_MAX_LINES="1000"       # Rotate log after this many lines
LOG_KEEP="5"              # Keep this many rotated log files

# ----------------- Sonarr / Radarr -----------------
SONARR_URL="http://sonarr:8989"
SONARR_API_KEY="d1684e618f71469fb12d0c4d98f6f4bc"
RADARR_URL="http://radarr:7878"
RADARR_API_KEY="9fc78fa0ea384574a014e06e9c58a90c"

# ----------------- Plex Library Refresh -------------
PLEX_URL="http://plex:32400"   # Base URL (no trailing slash)
PLEX_TOKEN="gYQ-8jcpirPeb_7EynY4"                 # Plex auth token (leave blank to disable refresh)
PLEX_SECTION_ID_TV="2"        # TV Shows library section key
PLEX_SECTION_ID_MOVIES="1"    # Movies library section key

# ----------------- Advanced / Testing -----------------
# The old "FORCE_CPU_TRANSCODE" flag is no longer used by the new script.
# To force a specific transcoder with the new script, set its "ENABLE_" flag
# to "true" and the others to "false". For example, to force local CPU:
# ENABLE_REMOTE_IGPU="false"
# ENABLE_REMOTE_DGPU="false"
# ENABLE_LOCAL_CPU="true"
#
# The old script still uses FORCE_CPU_TRANSCODE, which is left here for
# compatibility purposes.
FORCE_CPU_TRANSCODE="false"

# This flag enables hardware acceleration on the Synology NAS when using CPU transcoding.
# Requires the docker container to have access to '/dev/dri'.
# Set to "true" to enable, "false" to use software-based CPU transcoding.
#ENABLE_CPU_HW_ACCEL="true"

# ----------------- Transcoding Rules -----------------
# A space-separated list of video codecs to transcode.
# Example: "h265 hevc vp9"
# Default is "h265 hevc".
SOURCE_CODECS="h265 hevc"

# Set to "true" to transcode Matroska (.mkv) files.
# Set to "false" to skip them.
# Default is "true".
CONVERT_MKV="true"

# Any video file smaller than this size (in bytes) will be skipped.
# Useful for ignoring sample files. Default is 100MB.
# Default is 104857600.
MIN_SIZE="104857600"